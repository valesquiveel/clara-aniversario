<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feliz Aniversário, Meu Amor!</title>
    <style>
        /* Importação das fontes do Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Architects+Daughter&family=Kite+One&display=swap');

        /* --- Estilos Gerais e do Corpo --- */
        body {
            width: 100%;
            min-height: 100vh;
            background-color: #360A09; /* Cor de fundo escura */
            margin: 0;
            padding: 0;
            font-family: "Kite One", sans-serif; /* Fonte padrão */
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden; 
        }

        /* --- Estilos do Conteúdo Principal --- */
        main {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            width: 100%;
            flex-grow: 1; 
            padding: 10px 0;
        }

        /* --- Estilos do Cabeçalho e Rodapé --- */
        .hf { 
            color: white;
            font-size: clamp(20px, 4vw, 30px); 
            text-align: center;
            font-family: "Kite One", sans-serif;
            margin: 20px 0;
            padding: 0 15px;
            width: 90%;
            max-width: 800px;
            box-sizing: border-box;
        }

        .hf p {
            font-size: clamp(18px, 3.5vw, 28px); 
            margin: 0;
        }

        /* --- Container das Flores Decorativas --- */
        #divimgFlower {
            width: 90%;
            max-width: 800px; 
            height: 150px; 
            display: flex;
            justify-content: center; 
            position: relative;
            margin-bottom: -60px; /* Sobrepõe um pouco o Rect1 */
            z-index: 10; 
            pointer-events: none;
        }

        #imgflower1, #imgflower2 {
            width: 48%; 
            max-width: 230px;
            height: auto;
            position: absolute;
            top: 0;
            mix-blend-mode: screen; 
            filter: contrast(280%); 
        }
        #imgflower1 {
            left: 0%; 
            transform: translateX(-35%) scaleX(-1); 
        }
        #imgflower2 {
            right: 0%; 
            transform: translateX(35%);
        }

        /* --- Container Cinza Principal (Rect1) --- */
        #Rect1 {
            width: 85%;
            max-width: 700px; 
            min-height: 550px; 
            background-color: rgba(217, 217, 217, 0.85);
            border-radius: 8px; 
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px 20px 20px 20px; 
            box-sizing: border-box;
            position: relative; 
            overflow: hidden; 
            box-shadow: 0px 8px 20px rgba(0,0,0,0.25);
        }

        /* --- Container Inicial (RectFA - Feliz Aniversário) --- */
        #RectFA {
            width: 90%; 
            max-width: 480px;
            min-height: 400px;
            background-image: url('https://placehold.co/480x400/E8DACE/834923?text=Fundo+Pergaminho'); 
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: space-around; 
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            border-radius: 5px;
        }

        #parafusos {
            display: flex;
            justify-content: space-between;
            width: calc(100% - 20px); 
            position: absolute; 
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
        }
        #imgParafuso1, #imgParafuso2 {
            width: 30px; 
            height: 30px; 
        }

        #FA {
            color: #834923; 
            font-family: "Architects Daughter", cursive; 
            font-size: clamp(28px, 6vw, 48px); 
            margin: 20px 0;
            line-height: 1.25;
        }

        #estrelas {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px; 
            margin: 15px 0;
            width: 100%;
        }
        #imgEstrelas1, #imgEstrelas2 {
            width: 18%; 
            max-width: 70px; 
            height: auto;
            mix-blend-mode: soft-light;
        }

        #botaoContainer { 
            margin-top: 25px;
        }
        #botaoEstrela {
            width: 65px; 
            height: 65px; 
            background-image: url('https://placehold.co/65x65/8B4513/FFFFFF?text=★'); 
            background-size: contain; 
            background-repeat: no-repeat;
            background-position: center;
            background-color: transparent;
            border: none;
            cursor: pointer;
            transition: transform 0.3s ease, filter 0.3s ease;
            border-radius: 50%; 
        }
        #botaoEstrela:hover {
            transform: scale(1.1);
            filter: brightness(1.2);
        }

        /* --- Conteúdo Final (Carta Animada CSS/JS) --- */
        #conteudoFinal {
            width: 100%;
            height: 100%;
            display: none; 
            justify-content: center;
            align-items: center;
            position: absolute; 
            top: 0;
            left: 0;
        }

        #cartaContainer {
            position: relative;
            width: 300px; 
            height: 200px; 
            perspective: 1800px; 
            opacity: 0; 
            transform: scale(0.7) translateY(30px) rotateX(10deg) rotateY(-15deg);
            transform-style: preserve-3d; 
        }
        
        .envelope-base { 
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #B08D57; 
            border-radius: 4px;
            box-shadow: 0 3px 7px rgba(0,0,0,0.25);
            z-index: 1; 
            overflow: hidden; /* Mantido hidden inicialmente, JS mudará para visible */
        }
        
        .abas-internas-decorativas { 
            position: absolute;
            width: 100%;
            height: 100%;
            top:0; left:0;
            z-index: 2; 
        }
        .aba-interna { 
            position: absolute;
            background-color: #A07C4E; 
        }
        .aba-interna.esquerda {
            left: 0; top: 0; width: 120px; height: 100%; 
            clip-path: polygon(0% 0%, 100% 15%, 100% 85%, 0% 100%);
        }
        .aba-interna.direita {
            right: 0; top: 0; width: 120px; height: 100%;
            clip-path: polygon(100% 0%, 0% 15%, 0% 85%, 100% 100%);
        }
        .aba-interna.inferior { 
            bottom:0; left:0;
            width:100%; height: 90px; 
            clip-path: polygon(10% 100%, 50% 0%, 90% 100%); 
        }
        
        .envelope-aba-superior { 
            position: absolute;
            width: 100%;
            height: 105px; 
            top: 0; 
            left: 0;
            background-color: #E0E0E0; 
            transform-origin: top center; 
            transition: transform 1.0s ease-in-out, z-index 0s linear 1.0s; 
            z-index: 4; /* Acima da folha inicialmente */
            clip-path: polygon(0% 0%, 100% 0%, 50% 98%); 
            border-bottom: 1px solid #c0c0c0; 
            box-shadow: 0 -1px 2px rgba(0,0,0,0.05) inset;
        }
        .envelope-aba-superior.aberta {
            transform: rotateX(170deg) translateZ(-5px); 
            z-index: 0; /* Aba vai para trás da folha quando aberta */
        }
        
        #folhaMensagem {
            position: absolute;
            top: 0; 
            left: 50%;
            /* Posição inicial "dentro" do envelope e um pouco para baixo */
            transform: translateX(-50%) translateY(15px); 
            width: 90%; 
            height: 180px; 
            background-color: #fdfaf0; 
            border: 1px solid #e0dacd;
            border-radius: 3px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
            padding: 12px;
            box-sizing: border-box;
            opacity: 0; /* Começa invisível */
            color: #4a3b31; 
            font-family: "Architects Daughter", cursive;
            z-index: 3; /* Entre a base do envelope e a aba superior */
            /* AJUSTE NA TRANSIÇÃO: Opacidade anima primeiro, depois o transform */
            transition: opacity 0.4s ease-out, /* Duração 0.4s, sem delay relativo a .visivel */
                        transform 1.5s cubic-bezier(0.22, 0.61, 0.36, 1) 0.3s; /* Transformação começa 0.3s DEPOIS que .visivel é adicionado */
        }
        #folhaMensagem.visivel {
            opacity: 1; /* Torna-se visível */
            transform: translateX(-50%) translateY(-175px); /* Move para fora */
        }

        #folhaMensagem h1 {
            font-size: 1.1em; 
            margin: 0 0 6px 0;
            color: #7a5c43; 
            text-align: center;
        }
        #folhaMensagem p {
            font-size: 0.88em; 
            line-height: 1.4;
            margin: 0 0 6px 0;
        }

        /* --- Animações (Keyframes) --- */
        @keyframes sumirElementosIniciais {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.7); }
        }
        @keyframes desaparecerRectFA {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        @keyframes aparecerCartaContainer { 
            from { opacity: 0; transform: scale(0.7) translateY(40px) rotateX(20deg) rotateY(-20deg); }
            to { opacity: 1; transform: scale(1) translateY(0px) rotateX(0deg) rotateY(0deg); }
        }
    
        /* --- Classes de Animação --- */
        .animacao-sumir-elementos { animation: sumirElementosIniciais 0.7s forwards; }
        .animacao-desaparecer-rectfa { animation: desaparecerRectFA 1s forwards 0.3s; } 
        .animacao-aparecer-carta { animation: aparecerCartaContainer 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.2s forwards; } 

    </style>
</head>
<body>
    <header class="hf">
        <p>Porque seu aniversário não é só mais um dia qualquer...</p>
    </header>

    <main>
        <div id="divimgFlower">
            <img id="imgflower1" src="https://placehold.co/220x150/FFB6C1/FFB6C1?text=." alt="[Imagem de Flor Decorativa Esquerda]" onerror="this.style.display='none'">
            <img id="imgflower2" src="https://placehold.co/220x150/FFB6C1/FFB6C1?text=." alt="[Imagem de Flor Decorativa Direita]" onerror="this.style.display='none'">
        </div>

        <div id="Rect1">
            <div id="RectFA">
                <div id="parafusos">
                    <svg id="imgParafuso1" viewBox="0 0 100 100" fill="#7A7A7A"><circle cx="50" cy="50" r="45"/><path d="M30 50 L70 50 M50 30 L50 70" stroke="#505050" stroke-width="10"/></svg>
                    <svg id="imgParafuso2" viewBox="0 0 100 100" fill="#7A7A7A"><circle cx="50" cy="50" r="45"/><path d="M30 50 L70 50 M50 30 L50 70" stroke="#505050" stroke-width="10"/></svg>
                </div>
                <div>
                    <h1 id="FA">FELIZ ANIVERSÁRIO <br> MEU AMOR!</h1>
                </div>
                <div id="estrelas">
                        <img id="imgEstrelas1" src="https://placehold.co/80x80/FFD700/FFD700?text=." alt="[Imagem de Estrela Decorativa 1]" onerror="this.style.display='none'">
                        <img id="imgEstrelas2" src="https://placehold.co/70x70/FFD700/FFD700?text=." alt="[Imagem de Estrela Decorativa 2]" onerror="this.style.display='none'">
                </div>
                <div id="botaoContainer">
                    <button id="botaoEstrela" onclick="iniciarAnimacaoPrincipal()" aria-label="Abrir Mensagem"></button>
                </div>
            </div> 
            
            <div id="conteudoFinal">
                <div id="cartaContainer">
                    <div class="envelope-base"> 
                        <div class="abas-internas-decorativas"> 
                            <div class="aba-interna esquerda"></div>
                            <div class="aba-interna direita"></div>
                            <div class="aba-interna inferior"></div>
                        </div>
                        <div id="folhaMensagem"> 
                            <h1>Para Meu Amor, Clara</h1>
                            <p>Cada dia ao seu lado é o meu presente favorito. Que este novo ano seja repleto de alegrias, sonhos realizados e muito amor. Você é incrível!</p>
                            <p>Com todo o meu carinho.</p>
                        </div>
                    </div>
                    <div class="envelope-aba-superior"></div> 
                </div>
            </div> 
        </div> 
    </main>

    <footer class="hf">
        <p>...é o dia que o mundo ficou ainda mais lindo por causa de você.</p>
    </footer>

    <script>
        function iniciarAnimacaoPrincipal() {
            const rectFA = document.getElementById('RectFA');
            const parafusos = document.getElementById('parafusos');
            const estrelas = document.getElementById('estrelas');
            const faMessage = document.getElementById('FA');
            const botaoContainer = document.getElementById('botaoContainer');
            const botaoEstrela = document.getElementById('botaoEstrela');

            const conteudoFinal = document.getElementById('conteudoFinal');
            const cartaContainer = document.getElementById('cartaContainer');
            const envelopeAbaSuperior = document.querySelector('.envelope-aba-superior');
            const folhaMensagem = document.getElementById('folhaMensagem');
            const envelopeBase = document.querySelector('.envelope-base'); 

            console.log("Iniciando animação principal...");

            if (botaoEstrela) {
                botaoEstrela.disabled = true;
                console.log("Botão estrela desabilitado.");
            }

            const elementosRectFA = [parafusos, estrelas, faMessage, botaoContainer];
            elementosRectFA.forEach(el => {
                if (el) el.classList.add('animacao-sumir-elementos');
            });

            if (rectFA) rectFA.classList.add('animacao-desaparecer-rectfa');
            
            setTimeout(() => {
                if (rectFA) rectFA.style.display = 'none'; 
                if (conteudoFinal) conteudoFinal.style.display = 'flex'; 
                
                if (cartaContainer) {
                    cartaContainer.classList.add('animacao-aparecer-carta');
                    console.log("Envelope (cartaContainer) aparecendo.");
                }

                // Delay para a abertura da aba, relativo ao desaparecimento do RectFA
                setTimeout(() => {
                    if (envelopeAbaSuperior) {
                        envelopeAbaSuperior.classList.add('aberta');
                        console.log("Aba do envelope abrindo.");
                    }

                    // Timeout para a folha de mensagem (sincronizado com a abertura da aba)
                    // Este delay (600ms) é relativo ao início da abertura da aba
                    setTimeout(() => {
                        if (folhaMensagem) {
                            // Adicionar .visivel dispara a transição de opacidade imediatamente
                            // e a transição de transform após 0.3s (definido no CSS da folha)
                            folhaMensagem.classList.add('visivel');
                            console.log("Folha de mensagem .visivel adicionada. Opacidade animando.");

                            // Mudar overflow do envelope-base para visible um pouco ANTES da folha começar a se MOVER para fora.
                            // A transformação da folha (movimento) tem um delay de 0.3s na sua transição CSS.
                            // Mudamos o overflow um pouco antes desse delay de 0.3s terminar (ex: após 250ms).
                            setTimeout(() => {
                                if (envelopeBase) {
                                    envelopeBase.style.overflow = 'visible';
                                    console.log("Overflow do envelope-base definido para visible. Folha deve começar a deslizar em breve.");
                                }
                            }, 250); // 250ms após .visivel ser adicionado. (0.3s da transição da folha - 0.05s de margem = 0.25s)
                        }
                    }, 600); 

                }, 1400); 

            }, 1300); 
        }
    </script>
</body>
</html>
